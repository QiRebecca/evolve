{"id": "ab7a079c-8f60-4d94-9eb0-120a3ca5f4f6", "code": "from typing import Any\nfrom cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\n\n\nclass Solver:\n    TAG_SIZE = 16  # bytes (128-bit GCM tag)\n\n    def solve(self, problem: dict[str, Any], **kwargs) -> dict[str, bytes]:\n        \"\"\"\n        Encrypt plaintext with AES-GCM, returning ciphertext and tag.\n\n        Parameters\n        ----------\n        problem : dict\n            {\n                \"key\": bytes,\n                \"nonce\": bytes,\n                \"plaintext\": bytes,\n                \"associated_data\": bytes | None\n            }\n\n        Returns\n        -------\n        dict\n            {\n                \"ciphertext\": bytes,\n                \"tag\": bytes   # 16-byte authentication tag\n            }\n        \"\"\"\n        key: bytes = problem[\"key\"]\n        nonce: bytes = problem[\"nonce\"]\n        plaintext: bytes = problem[\"plaintext\"]\n        aad: bytes | None = problem.get(\"associated_data\", None)\n\n        # Build low-level AES-GCM cipher (OpenSSL backend is chosen automatically)\n        encryptor = Cipher(\n            algorithms.AES(key),\n            modes.GCM(nonce),\n        ).encryptor()\n\n        # Attach AAD if provided and non-empty\n        if aad:\n            encryptor.authenticate_additional_data(aad)\n\n        # Single update is fastest; OpenSSL handles chunking internally\n        ciphertext = encryptor.update(plaintext) + encryptor.finalize()\n        tag = encryptor.tag  # 16-byte tag produced without extra copy\n\n        return {\"ciphertext\": ciphertext, \"tag\": tag}", "language": "python", "parent_id": "cd42c4b0-8a9f-4b22-ba73-38869fa04cf4", "generation": 1, "timestamp": 1762873838.4997487, "iteration_found": 12, "metrics": {"combined_score": 1.0718190498026265, "mean_speedup": 1.0718190498026265, "num_valid": 10.0, "success_rate": 1.0, "accuracy": 1.0}, "complexity": 0.0, "diversity": 0.0, "metadata": {"island": 1}, "prompts": null, "artifacts_json": "{\"summary.json\": \"{\\n  \\\"aggregate_metrics\\\": {\\n    \\\"num_evaluated\\\": 10,\\n    \\\"num_valid\\\": 10,\\n    \\\"num_errors\\\": 0,\\n    \\\"num_timeouts\\\": 0,\\n    \\\"accuracy\\\": 1.0,\\n    \\\"success_rate\\\": 1.0,\\n    \\\"mean_speedup\\\": 1.0718190498026265,\\n    \\\"median_speedup\\\": 1.0705176085734949,\\n    \\\"avg_solver_time_ms\\\": 95.45468269999999,\\n    \\\"avg_oracle_time_ms\\\": 102.3102205,\\n    \\\"total_runtime_speedup\\\": 1.0718198165463078\\n  },\\n  \\\"sample_results\\\": [\\n    {\\n      \\\"problem_id\\\": \\\"42\\\",\\n      \\\"success\\\": true,\\n      \\\"is_valid\\\": true,\\n      \\\"timeout_occurred\\\": false,\\n      \\\"min_time_ms\\\": 95.184497,\\n      \\\"mean_ms\\\": 95.184497,\\n      \\\"values_ms\\\": [\\n        95.184497\\n      ],\\n      \\\"elapsed_ms\\\": 95.184497,\\n      \\\"validation_result\\\": {\\n        \\\"success\\\": true,\\n        \\\"error_type\\\": \\\"none\\\",\\n        \\\"error\\\": null\\n      },\\n      \\\"speedup\\\": 1.070756091719432,\\n      \\\"baseline_time_ms\\\": 101.91938,\\n      \\\"solver_min_time_ms\\\": 95.184497\\n    },\\n    {\\n      \\\"problem_id\\\": \\\"43\\\",\\n      \\\"success\\\": true,\\n      \\\"is_valid\\\": true,\\n      \\\"timeout_occurred\\\": false,\\n      \\\"min_time_ms\\\": 95.294499,\\n      \\\"mean_ms\\\": 95.294499,\\n      \\\"values_ms\\\": [\\n        95.294499\\n      ],\\n      \\\"elapsed_ms\\\": 95.294499,\\n      \\\"validation_result\\\": {\\n        \\\"success\\\": true,\\n        \\\"error_type\\\": \\\"none\\\",\\n        \\\"error\\\": null\\n      },\\n      \\\"speedup\\\": 1.0547522685438537,\\n      \\\"baseline_time_ms\\\": 100.512089,\\n      \\\"solver_min_time_ms\\\": 95.294499\\n    },\\n    {\\n      \\\"problem_id\\\": \\\"44\\\",\\n      \\\"success\\\": true,\\n      \\\"is_valid\\\": true,\\n      \\\"timeout_occurred\\\": false,\\n      \\\"min_time_ms\\\": 95.454844,\\n      \\\"mean_ms\\\": 95.454844,\\n      \\\"values_ms\\\": [\\n        95.454844\\n      ],\\n      \\\"elapsed_ms\\\": 95.454844,\\n      \\\"validation_result\\\": {\\n        \\\"success\\\": true,\\n        \\\"error_type\\\": \\\"none\\\",\\n        \\\"error\\\": null\\n      },\\n      \\\"speedup\\\": 1.0771323663783894,\\n      \\\"baseline_time_ms\\\": 102.817502,\\n      \\\"solver_min_time_ms\\\": 95.454844\\n    }\\n  ],\\n  \\\"config\\\": {\\n    \\\"task_name\\\": \\\"aes_gcm_encryption\\\",\\n    \\\"data_dir\\\": \\\"/data/zq/evolve/AlgoTune/data\\\",\\n    \\\"split\\\": \\\"train\\\",\\n    \\\"max_samples\\\": null,\\n    \\\"timeout_multiplier\\\": null,\\n    \\\"min_timeout_seconds\\\": null,\\n    \\\"max_timeout_seconds\\\": null,\\n    \\\"num_runs\\\": 5,\\n    \\\"warmup_runs\\\": null,\\n    \\\"test_mode\\\": false,\\n    \\\"generation_file\\\": \\\"/data/zq/evolve/reports/generation.json\\\"\\n  },\\n  \\\"generation_avg_baseline_ms\\\": 98.98897910000001\\n}\"}", "artifact_dir": null, "embedding": null}