{"id": "063a63bb-761a-4781-9022-dbdb26e19960", "code": "# Copyright (c) 2025 Ori Press and the AlgoTune contributors\n# https://github.com/oripress/AlgoTune\nimport logging\n\nimport numpy as np\nfrom scipy import signal\n\nfrom AlgoTuneTasks.base import register_task, Task\n\n\n@register_task(\"convolve_1d\")\nclass Convolve1D(Task):\n    def __init__(self, **kwargs):\n        super().__init__(**kwargs)\n        self.mode = \"full\"\n\n    def generate_problem(self, n: int = 1, random_seed: int = 1234) -> tuple:\n        rng = np.random.default_rng(random_seed)\n        a = rng.standard_normal(30 * n)\n        b = rng.standard_normal(8 * n)\n        return (a, b)\n\n    def solve(self, problem: tuple) -> np.ndarray:\n        a, b = problem\n        return signal.convolve(a, b, mode=self.mode)\n\n    def is_solution(self, problem: tuple, solution: np.ndarray) -> bool:\n        \"\"\"\n        Check if the solution is valid and optimal.\n\n        For this task, a solution is valid if its error is within tolerance compared\n        to the optimal solution computed by self.solve().\n\n        :param problem: Tuple containing input arrays a and b.\n        :param solution: Proposed convolution result.\n        :return: True if the solution is valid and optimal, False otherwise.\n        \"\"\"\n        a, b = problem\n        reference = signal.convolve(a, b, mode=self.mode)\n        tol = 1e-6\n        error = np.linalg.norm(solution - reference) / (np.linalg.norm(reference) + 1e-12)\n        if error > tol:\n            logging.error(f\"Convolve1D error {error} exceeds tolerance {tol}.\")\n            return False\n        return True\n", "language": "python", "parent_id": null, "generation": 0, "timestamp": 1762867084.268188, "iteration_found": 0, "metrics": {"combined_score": 0.0, "mean_speedup": 0.0, "num_valid": 0.0, "success_rate": 0.0, "accuracy": 0.0}, "complexity": 0.0, "diversity": 0.0, "metadata": {"island": 0}, "prompts": null, "artifacts_json": null, "artifact_dir": null, "embedding": null}